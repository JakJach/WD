@model TeacherViewModel
@{
    ViewData["Title"] = "Wirtualny Dziekanat";
}

<div class="container-fluid">
<section id="tabs" class="project-tab container-fluid">
    <div class="row w-100">
        <table class="table" cellspacing="2">
            <thead>
                <tr><th>Twoje dane:</th><th></th></tr>
            </thead>
            <tbody>
                <tr>
                    <td>Imię:</td>
                    <td>@Model.LoggedInTeacher.Name</td>
                </tr>
                <tr>
                    <td>Nazwisko:</td>
                    <td>@Model.LoggedInTeacher.Surname</td>
                </tr>
                <tr>
                    <td>Adres e-mail:</td>
                    <td>@Model.LoggedInTeacher.Email</td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="row w-100">
        <div class="col-12">
            <nav>
                <div class="nav nav-tabs nav-fill" id="nav-tab" role="tablist">
                    <a class="nav-item nav-link bg-success text-white active" id="nav-projects-tab" href="#nav-projects" data-toggle="tab" role="tab" aria-controls="nav-projects" aria-selected="true">Projekty</a>
                    <a class="nav-item nav-link bg-dark text-white" id="nav-thesis-tab" href="#nav-thesis" data-toggle="tab" role="tab" aria-controls="nav-thesis" aria-selected="false">Prace dyplomowe</a>
                    <a class="nav-item nav-link bg-danger text-white" id="nav-notes-tab" href="#nav-notes" data-toggle="tab" role="tab" aria-controls="nav-notes" aria-selected="false">Oceny końcowe</a>
                </div>
            </nav>
            <div class="tab-content" id="nav-tabContent">
                <div class="tab-pane fade show active" id="nav-projects" role="tabpanel" aria-labelledby="nav-projects-tab">
                    <table class="table" cellspacing="0">
                        <thead>
                            <tr>
                                <th>Przedmiot</th>
                                <th>Tytuł projektu</th>
                                <th>Informacje</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (Project project in Model.TeacherProjects)
                            {
                                <tr>
                                    @foreach (Classes classes in Model.TeacherClasses)
                                    {
                                        @if (classes.ID == project.ClassesID)
                                        {
                                            <td>@classes.Name</td>

                                        }
                                    }
                                    <td>@project.Name</td>
                                    @if (project.IsUploaded)
                                    {
                                        @if (project.IsReviewed)
                                        {
                                            <td class="text-success">Już oceniłeś ten projekt na: @project.ReviewerNote</td>
                                        }
                                        else
                                        {
                                            <td><a class="btn btn-dark text-white" asp-controller="Teacher" asp-action="ReviewProject" asp-route-id="@project.ID">Oceń projekt</a></td>
                                        }
                                    }
                                    else
                                    {
                                        <td class="text-dark">Projekt nie został jeszcze złożony</td>
                                    }
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
                <div id="nav-thesis" class="tab-pane fade" role="tabpanel" aria-labelledby="nav-thesis-tab">
                    <div class="container-fluid">
                        <table class="table" cellspacing="0">
                            @if (Model.TeacherPromotingTheses.ToArray().Length == 0)
                            {
                                <thead class="text-white bg-dark">
                                    <tr class="text-center">Brak promowanych prac</tr>
                                </thead>
                            }
                            else
                            {
                                <thead>
                                    <tr class="text-white bg-dark">
                                        <th colspan="6" class="text-center">Promowane prace:</th>
                                    </tr>
                                    <tr>
                                        <th style="width: 16.66%">Imię i nazwisko studenta</th>
                                        <th style="width: 16.66%">Tytuł pracy</th>
                                        <th style="width: 16.66%">Ocena promotora</th>
                                        <th style="width: 16.66%">Opinia promotora</th>
                                        <th style="width: 16.66%">Ocena recenzenta</th>
                                        <th style="width: 16.66%">Recenzja</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (Thesis thesis in Model.TeacherPromotingTheses)
                                    {
                                        <tr>
                                            <td>
                                                @(Model.TeacherStudents.FirstOrDefault(s => s.ID == thesis.StudentID).Name
                                                + " " + Model.TeacherStudents.FirstOrDefault(s => s.ID == thesis.StudentID).Surname)
                                            </td>
                                            <td>@thesis.Title</td>
                                            @if (thesis.IsUploaded)
                                            {
                                                @if (thesis.IsCheckedByPromoter)
                                                {
                                                    <td>@thesis.PromoterNote</td>
                                                    <td>@thesis.PromoterOpinion</td>
                                                    @if (thesis.IsCheckedByReviewer)
                                                    {
                                                        <td class="text-success">@thesis.ReviewerNote</td>
                                                        <td>@thesis.Review</td>
                                                    }
                                                    else
                                                    {
                                                        <td class="text-dark">BRAK</td>
                                                        <td class="text-dark">Recenzent nie dodał jeszcze swojej recenzji</td>
                                                    }
                                                }
                                                else
                                                {
                                                    <td><a asp-controller="Teacher" asp-action="ReviewThesis" asp-route-id="@thesis.ID" asp-route-type="1" class="btn btn-dark text-white">Oceń pracę</a></td>
                                                    <td>Praca czeka na twoją ocenę</td>
                                                    <td></td><td></td>
                                                }
                                            }
                                            else
                                            {
                                                <td class="text-danger">BRAK</td>
                                                <td>Student nie dodał jeszcze pracy</td>
                                                <td></td><td></td>
                                            }
                                        </tr>
                                    }
                                </tbody>
                            }
                        </table>
                        <table class="table" cellspacing="0">

                            @if (Model.TeacherReviewingTheses.ToArray().Length == 0)
                            {
                                <thead class="text-dark text-center">
                                    <tr>
                                        <th colspan="6" class="text-center">Brak recenzowanych prac</th>
                                    </tr>
                                </thead>
                            }
                            else
                            {
                                <thead>
                                    <tr class="text-white bg-dark">
                                        <th colspan="6" class="text-center">Recenzowane prace:</th>
                                    </tr>
                                    <tr>
                                        <th style="width: 16.66%">Imię i nazwisko studenta</th>
                                        <th style="width: 16.66%">Tytuł pracy</th>
                                        <th style="width: 16.66%">Ocena promotora</th>
                                        <th style="width: 16.66%">Opinia promotora</th>
                                        <th style="width: 16.66%">Ocena recenzenta</th>
                                        <th style="width: 16.66%">Recenzja</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (Thesis thesis in Model.TeacherReviewingTheses)
                                    {
                                        <tr>
                                            <td>
                                                @(Model.TeacherStudents.FirstOrDefault(s => s.ID == thesis.StudentID).Name
                                                + " " + Model.TeacherStudents.FirstOrDefault(s => s.ID == thesis.StudentID).Surname)
                                            </td>
                                            <td>@thesis.Title</td>
                                            @if (thesis.IsUploaded)
                                            {
                                                @if (thesis.IsCheckedByPromoter)
                                                {
                                                    <td>@thesis.PromoterNote</td>
                                                    <td>@thesis.PromoterOpinion</td>
                                                    @if (thesis.IsCheckedByReviewer)
                                                    {
                                                        <td class="text-success">@thesis.ReviewerNote</td>
                                                        <td>@thesis.Review</td>
                                                    }
                                                    else
                                                    {
                                                        <td><a asp-controller="Teacher" asp-action="ReviewThesis" asp-route-id="@thesis.ID" asp-route-type="2" class="btn btn-dark text-white">Zrecenzuj pracę</a></td>
                                                        <td class="text-dark">Praca czeka na twoją recenzję</td>
                                                    }
                                                }
                                                else
                                                {
                                                    <td class="text-danger">BRAK</td>
                                                    <td>Promotor nie ocenił jeszcze pracy</td>
                                                    <td></td><td></td>
                                                }
                                            }
                                            else
                                            {
                                                <td class="text-danger">BRAK</td>
                                                <td>Student nie dodał jeszcze pracy</td>
                                                <td></td><td></td>
                                            }
                                        </tr>
                                    }
                                </tbody>
                        }
                            </table>
                        </div>
                </div>
                <div id="nav-notes" class="tab-pane fade" role="tabpanel" aria-labelledby="nav-notes-tab">
                    <table class="table" cellspacing="0">
                        <thead>
                            <tr>
                                <th>Przedmiot</th>
                                <th>Student</th>
                                <th>Ocena końcowa</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (StudentFinalNote finalNote in Model.StudentFinalNotes)
                            {
                                <tr>
                                    <td>@finalNote.Classes.Name</td>
                                    <td>@(finalNote.Student.Name + " " + finalNote.Student.Surname)</td>
                                    <td>
                                        @if (finalNote.Student.FinalNotes.ElementAt(finalNote.Classes.ID) == 0)
                                        {
                                            <a asp-controller="Teacher" asp-action="AddFinalNote" asp-route-classesID="@finalNote.Classes.ID"
                                               asp-route-studentID="@finalNote.Student.ID" class="btn btn-dark text-white">Dodaj ocenę końcową</a>
                                        }
                                        else
                                        {
                                            @finalNote.Student.FinalNotes.ElementAt(finalNote.Classes.ID)
                                        }
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</section>
</div>